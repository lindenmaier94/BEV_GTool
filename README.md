# BEV_GTool

### BEV Ground Truth Generation and Annotation Tool 
BEV GTool is a program that supports generating GT (ground truth) of automotive scenarios consisting of a video sequence and radar measurement. Besides the annotation boxes in the space, the tool considers the object state in BEV (bird's-eye view) space as well. The application requires the detections provided by any 2D bounding box object detector run on the video frames. We suggest state-of-the-art deep-learning-based computer-vision algorithms such as Yolov4-P6. Since the application was designed in Matlab App Designer, it requires Matlab Runtime 9.11 installation. Anyone can use it for non-commercial purposes.

![My image](https://github.com/lindenmaier94/BEV_GTool/blob/main/BEV_GTool_GUI.png)

### Download Latest Executable
* [BEV GTool 1.0](https://github.com/lindenmaier94/BEV_GTool/releases/download/BEV_GTool_1_0/BEV_GTool_1_0.zip)
(only binary executables can be downloaded)

### Main Features
* Automatic Pre-Generation
  * automatically generating annotation boxes in image space by tracking the input detections
  * automatically generating the ground truth in BEV space by fusing the monocular tracks with radar detections
* Correcting the Pre-Generated Ground Truth
  * modifying the objects' position in BEV space
  * modifying the bounding box of the objects on the images
  * propagating the modifications by BEV tracking
  * creating new objects
  * deleting false detections/tracks
* Windows only

### Instructions
* Prerequisites
  * Download and install [Matlab Runtime 9.11](https://ssd.mathworks.com/supportfiles/downloads/R2021b/Release/7/deployment_files/installer/complete/win64/MATLAB_Runtime_R2021b_Update_7_win64.zip)
  * Run a 2D object detector on the video sequence
* Load video
  * only MP4 format is accepted
* Load camera params
  * including the intrinsic params, such as focal lengths, optical center, distortions, etc.,
  * and the homography matrix
  * in JSON format ([see in sample data](https://github.com/lindenmaier94/BEV_GTool/blob/main/Sample%20Data/cameraParams.json))
* Load synchron file
  * a lookup table with the corresponding time and frame ID pairs
  * in a CSV file ([see in sample data](https://github.com/lindenmaier94/BEV_GTool/blob/main/Sample%20Data/CameraSynchronLUT.csv))
  * linear interpolation is applied between the lookup table points
* Load radar detections
  * in a CSV file ([see the format in the sample data](https://github.com/lindenmaier94/BEV_GTool/blob/main/Sample%20Data/RadarDetections.csv))
* Load monocular object detections
  * in a CSV file ([see the format in the sample data](https://github.com/lindenmaier94/BEV_GTool/blob/main/Sample%20Data/YOLO.csv))
* Load lane lines (optional)
  * defined with a 2nd-degree polynomials in BEV space
  * in a CSV file ([see the format in the sample data](https://github.com/lindenmaier94/BEV_GTool/blob/main/Sample%20Data/LineDetections.csv))
* Automatic Pre-Generation
  * generating automatic ground truth
* Save/load session
  * save the current status of ground truth generation
  * load previously saved session to continue
* Navigating video frames
  * step frame-by-frame with Step forward and Step backward buttons
  * specify the target frame ID in the edit box and press Enter
* Correcting objects
  * select the object intended to be modified by clicking on the corresponding '+' marker in BEV- or image space (the middle of the bounding box bottom edge)
  * the object will be highlighted if it is selected successfully (at most, one object can be selected at once)
  * click on the target point in the BEV or image window where the BEV position or the bounding box is intended to be moved, respectively
  * modify the size of the bounding box by clicking and dragging the edges or corners of the bounding box
* Setting track and class ID
  * double click on the the corresponding '+' marker in BEV- or image space (the middle of the bounding box bottom edge)
  * a popup window will appear where the track and class ID of the track can be modified in the corresponding edit text boxes
  * push the Submit button if the updates are ready
* Tracking
  * move the object in the BEV space close to the corresponding (which was likely to be generated by that object) radar detection 
  * switch on the Tracking toggle button
  * propagate the modification of the object's BEV position by stepping the frames forward or backward: the objects' BEV position will be predicted according to the velocity of the corresponding radar detections
  * accept tracking if the predicted object positions seem to be satisfactory
* Creating and deleting objects
  * create a new track by double click on the target point of the image space, then modify its initial bounding box, BEV position, and class ID according to the previous points
  * delete an object on the actual frame by right click on the corresponding marker point
  * delete an entire track by Ctrl + right click on the corresponding marker point
* Hotkeys
  * Step forward - 'e'
  * Step backward - 'b'
  * Accept tracking - Space
